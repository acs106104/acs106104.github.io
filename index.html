<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
</head>
<body>
    <p id="test"></p>
    <script>
        var x,y,z;
        document.getElementById("test").innerHTML = "x:"+x+"<br>"+
                                                    "y:"+y+"<br>"+
                                                    "z:"+z;

        var lastX,lastY,lastZ,
            lastShake = new Date().getTime(),
            threshold = 10;
        
        //監聽動作感測事件
        if (window.DeviceMotionEvent) {
            window.addEventListener('devicemotion',deviceMotionHandler, false);
        }
        else{
            alert('DeviceMotionEvent not support');
        }
        //獲取重力加速度
        function deviceMotionHandler(eventData) {
            var acceleration = eventData.accelerationIncludingGravity;
            x = acceleration.x;
            y = acceleration.y;
            z = acceleration.z;
            console.log(x);
        }

        if(lastX !== null && lastY !== null && lastZ !== null){
            //Get the distance moved
            var diffX = Math.abs(x-lastX);
            var diffY = Math.abs(y-lastY);
            var diffZ = Math.abs(z-lastZ);
            //shake detection code will go here
        }
        lastX = x;
        lastY = y;
        lastZ = z;

        if(diffX > threshold && diffY > threshold ||
            diffX > threshold && diffZ > threshold ||
            diffY > threshold && diffZ > threshold){
            var now = new Date().getTime();
            var diffTime = now - lastShake;
            if(diffTime > 500){
                alert("Shaked!");
                lastShake = now;
            }
        }
    </script>
</body>
</html>